files:
  /etc/nginx/conf.d/https.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      # HTTPS server

      server {
          listen       443;
          server_name  localhost;

          ssl                  on;
          ssl_certificate      /etc/pki/tls/certs/server.crt;
          ssl_certificate_key  /etc/pki/tls/certs/server.key;

          ssl_session_timeout  5m;

          ssl_protocols  TLSv1 TLSv1.1 TLSv1.2;
          ssl_prefer_server_ciphers   on;

          # For enhanced health reporting support, uncomment this block:

          #if ($time_iso8601 ~ "^(\d{4})-(\d{2})-(\d{2})T(\d{2})") {
          #    set $year $1;
          #    set $month $2;
          #    set $day $3;
          #    set $hour $4;
          #}
          #access_log /var/log/nginx/healthd/application.log.$year-$month-$day-$hour healthd;
          #access_log  /var/log/nginx/access.log  main;

          location / {
              proxy_pass  http://nodejs;
              proxy_set_header   Connection "";
              proxy_http_version 1.1;
              proxy_set_header        Host            $host;
              proxy_set_header        X-Real-IP       $remote_addr;
              proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
              proxy_set_header        X-Forwarded-Proto https;
          }
      }
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIDsjCCApoCCQDLY8awn7ZxtTANBgkqhkiG9w0BAQsFADCBmjELMAkGA1UEBhMC
      QU0xGDAWBgNVBAgMD0Rhdml0IFZhcmRhbnlhbjEQMA4GA1UEBwwHWWVyZXZhbjEQ
      MA4GA1UECgwHRW50b3VyczEUMBIGA1UECwwLRGV2ZWxvcG1lbnQxFDASBgNVBAMM
      C2VudG91cnMuYXBwMSEwHwYJKoZIhvcNAQkBFhJqZWRhdmFyZEBnbWFpbC5jb20w
      HhcNMjAwNzI0MDk0OTAxWhcNMjEwNzI0MDk0OTAxWjCBmjELMAkGA1UEBhMCQU0x
      GDAWBgNVBAgMD0Rhdml0IFZhcmRhbnlhbjEQMA4GA1UEBwwHWWVyZXZhbjEQMA4G
      A1UECgwHRW50b3VyczEUMBIGA1UECwwLRGV2ZWxvcG1lbnQxFDASBgNVBAMMC2Vu
      dG91cnMuYXBwMSEwHwYJKoZIhvcNAQkBFhJqZWRhdmFyZEBnbWFpbC5jb20wggEi
      MA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC/5ovJRP8Xdn5Sc/9WCPDU0SNJ
      HrpFn22/Z0283xzSsKke4lBYSYThZ1LjbZnXVTE0+Ypdcw/HTuhurhdMCKlYrDXk
      25j7vJIiLbfcwAe62rpSQksZ4CkNsnu5j1e4TjkIMposxOMbs553LK66OhUyftFm
      6NH3MEhJnPHYk2uzvyNj327sIjW1ugTN1yodmTi+GDatc3Tzn3lZmHPF6x7PInEn
      GESJa2Z2wbSw3Geg32+W26YkhjUOj6rL1Jhl1/enU1kuhBXxf/PExGrKMdWSSWuc
      orOVoITbxKa8AHvnlj33rUWrPywsD5Gg+zhodybFp0TzHjVTpV/gvtjMLdQ5AgMB
      AAEwDQYJKoZIhvcNAQELBQADggEBAL8G+2fgM84PGO/pObPdcF9CWzEPHibudYjq
      ravM5g8KaHTjgmH6qhxNSBZoMYw00CzzYLzKNv0Do6iMa77QQwqgl/kpwY81qngq
      15+hc/Q7rDrAKD/bnW9k+5P+d2jBiVoJLsiMNls9i7mToQjULbu6b0tXO3DqcBAE
      dSrDyBzKIatp69TrEwnqy924XehYBW4j17koOllyoi3Uw1WkCTB6budZ3wYKuoqz
      YJtAH5D3u52G/VK0IiJnyqOJmr4vWQ8DZUthJ+GaSS9ex0Z/D1xjExoxOkX+vDCi
      AS9laEhj5NvAJ40EHTro/gHaHVYkIH0SZZDTlI9eB+YfF0RdTmQ=
      -----END CERTIFICATE-----

  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEogIBAAKCAQEAv+aLyUT/F3Z+UnP/Vgjw1NEjSR66RZ9tv2dNvN8c0rCpHuJQ
      WEmE4WdS422Z11UxNPmKXXMPx07obq4XTAipWKw15NuY+7ySIi233MAHutq6UkJL
      GeApDbJ7uY9XuE45CDKaLMTjG7OedyyuujoVMn7RZujR9zBISZzx2JNrs78jY99u
      7CI1tboEzdcqHZk4vhg2rXN08595WZhzxesezyJxJxhEiWtmdsG0sNxnoN9vltum
      JIY1Do+qy9SYZdf3p1NZLoQV8X/zxMRqyjHVkklrnKKzlaCE28SmvAB755Y9961F
      qz8sLA+RoPs4aHcmxadE8x41U6Vf4L7YzC3UOQIDAQABAoIBACtTFYQfO6hEbEiZ
      P7Bg3F5vyROdCFjnoZNw8zAM/yjiEYyTc6g7EPECrsgB2pWu+ikHnaFzdMB+pCM4
      0rGr0u/eEVzV5zgOXr+wqq3//L7G2wHvTZ1N6nbZMO232woVPvMG2Z/543xBlSk6
      wUfyDQ8VapldPuob0HYuJLvMrKgrvqAaCOK4Aw7ANxqBN6LgS5C+Nw7h+1V5TqgC
      Hu5KYaWVS/EQs94qJBCgctKR6VsT8rWnOesdBPc0TeP7B8FOFtOljS3PSZs7WwWv
      0Isz+qAKHFW4Hn5H+1cfaNieuuEPE13TRHT+CWXbB0NKgfbK1S5H4lPickO+gkAx
      tmBBkgECgYEA7/Yf1jGycUOS3ekPsNPnG1PdlvhghQ4g5E34bEcdabAoQ4XjV5It
      rAD/2B9Ebghnt0MSShBN8cGDwrtnon6cJ/npkrDcIs4z5NCQLUGbGhD0LM8yrSaL
      X8O+5PGPWb6YN0yHQEbrjfqbuOzw/31VdyFr/ro2L0Ueu1JBIVnE8jECgYEAzLoS
      xHRh9tnFDWDLT/gZ0LbzIrLpGOCAGj9yySHD80Uyw4/2e+ZR1Eu9O/RFev9JvCzb
      tQoz+Hu9Z+Le81Y2EJB6TT/qH2MoyuePJBUAqHkD62jwnBbMubLct53hHteAMuB2
      VPn669imw5+7PAKmAxZEiaKBEwepNlS0ABTFuIkCgYBW+IS3dFGxfYVYiqUWOOc1
      X2Mb2a/Z6bIALUZRsEC30pH1TyyDy8Zj5gTUhxidLMyyfku9rkUhzzp7NMMuAOeG
      Ea0XbqSKtOPYFcN7s6CMhQKKzxoV6bdwIRkqD2ceZtbyi/klUc8EKYWRM8dxQjLc
      t69VppYG8e1ehUR32vpnsQKBgHnEYs0+e9YbCL1ASS0zYAdoCY0l5MbLIOZ7voYq
      8yWKjvsKcYyYHSusMM2sKHdTyEOIWtV/UBIHZ0yXAAyzxkxr4pJ35YTtsaGdwOGx
      LEcIU3B9Zj8wwGvjGqyL1w5FFxcrsrYwSTJmFipcozy6RounfvRuF19+OwL5tmYl
      9MQhAoGAR4attt8Zb+xtevnuXStl61rVIpA+wyy7K7LvVTx1CBMvwr8kSPO4Sx39
      5KhvUr3bgTYYs11x3zPe4vzaNpPsSM1a5Uhpybr3sTUjpbJZmzw6YF5VkWoPtYT1
      79xFGu98PxfrOATDCSeKxggaMtmq01LaaEvCsMaYpjq22xgC7CI=
      -----END RSA PRIVATE KEY-----